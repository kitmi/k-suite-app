"use strict";

require("source-map-support/register");

const App = require('../App');

const {
  combine,
  colorize,
  simple
} = App.loggerProvider.format;

function startCommand(commandName, commandHandler, config, loggerOpt) {
  if (typeof loggerOpt === 'string') {
    loggerOpt = {
      level: loggerOpt
    };
  }

  loggerOpt = {
    colorize: true,
    level: 'info',
    ...loggerOpt
  };
  let cliApp = new App(commandName, {
    logger: {
      "transports": [{
        "type": "console",
        "options": {
          "level": loggerOpt.level,
          "format": loggerOpt.colorize ? combine(colorize(), simple()) : simple()
        }
      }]
    },
    loadConfigFromOptions: true,
    config
  });
  cliApp.start_().then(commandHandler).then(() => cliApp.stop_()).catch(error => {
    cliApp.logError(error);
    process.exit(1);
  });
}

module.exports = startCommand;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcHBzL2NvbW1hbmQuanMiXSwibmFtZXMiOlsiQXBwIiwicmVxdWlyZSIsImNvbWJpbmUiLCJjb2xvcml6ZSIsInNpbXBsZSIsImxvZ2dlclByb3ZpZGVyIiwiZm9ybWF0Iiwic3RhcnRDb21tYW5kIiwiY29tbWFuZE5hbWUiLCJjb21tYW5kSGFuZGxlciIsImNvbmZpZyIsImxvZ2dlck9wdCIsImxldmVsIiwiY2xpQXBwIiwibG9nZ2VyIiwibG9hZENvbmZpZ0Zyb21PcHRpb25zIiwic3RhcnRfIiwidGhlbiIsInN0b3BfIiwiY2F0Y2giLCJlcnJvciIsImxvZ0Vycm9yIiwicHJvY2VzcyIsImV4aXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUEsTUFBTUEsR0FBRyxHQUFHQyxPQUFPLENBQUMsUUFBRCxDQUFuQjs7QUFDQSxNQUFNO0FBQUVDLEVBQUFBLE9BQUY7QUFBV0MsRUFBQUEsUUFBWDtBQUFxQkMsRUFBQUE7QUFBckIsSUFBZ0NKLEdBQUcsQ0FBQ0ssY0FBSixDQUFtQkMsTUFBekQ7O0FBRUEsU0FBU0MsWUFBVCxDQUFzQkMsV0FBdEIsRUFBbUNDLGNBQW5DLEVBQW1EQyxNQUFuRCxFQUEyREMsU0FBM0QsRUFBc0U7QUFDbEUsTUFBSSxPQUFPQSxTQUFQLEtBQXFCLFFBQXpCLEVBQW1DO0FBQy9CQSxJQUFBQSxTQUFTLEdBQUc7QUFDUkMsTUFBQUEsS0FBSyxFQUFFRDtBQURDLEtBQVo7QUFHSDs7QUFFREEsRUFBQUEsU0FBUyxHQUFHO0FBQ1JSLElBQUFBLFFBQVEsRUFBRSxJQURGO0FBRVJTLElBQUFBLEtBQUssRUFBRSxNQUZDO0FBR1IsT0FBR0Q7QUFISyxHQUFaO0FBTUEsTUFBSUUsTUFBTSxHQUFHLElBQUliLEdBQUosQ0FBUVEsV0FBUixFQUFxQjtBQUM5Qk0sSUFBQUEsTUFBTSxFQUFFO0FBQ0osb0JBQWMsQ0FDVjtBQUNJLGdCQUFRLFNBRFo7QUFFSSxtQkFBVztBQUNQLG1CQUFTSCxTQUFTLENBQUNDLEtBRFo7QUFFUCxvQkFBVUQsU0FBUyxDQUFDUixRQUFWLEdBQXFCRCxPQUFPLENBQUNDLFFBQVEsRUFBVCxFQUFhQyxNQUFNLEVBQW5CLENBQTVCLEdBQXFEQSxNQUFNO0FBRjlEO0FBRmYsT0FEVTtBQURWLEtBRHNCO0FBWTlCVyxJQUFBQSxxQkFBcUIsRUFBRSxJQVpPO0FBYTlCTCxJQUFBQTtBQWI4QixHQUFyQixDQUFiO0FBZ0JBRyxFQUFBQSxNQUFNLENBQUNHLE1BQVAsR0FBZ0JDLElBQWhCLENBQXFCUixjQUFyQixFQUFxQ1EsSUFBckMsQ0FBMEMsTUFBTUosTUFBTSxDQUFDSyxLQUFQLEVBQWhELEVBQWdFQyxLQUFoRSxDQUFzRUMsS0FBSyxJQUFJO0FBQzNFUCxJQUFBQSxNQUFNLENBQUNRLFFBQVAsQ0FBZ0JELEtBQWhCO0FBRUFFLElBQUFBLE9BQU8sQ0FBQ0MsSUFBUixDQUFhLENBQWI7QUFDSCxHQUpEO0FBS0g7O0FBRURDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQmxCLFlBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQXBwID0gcmVxdWlyZSgnLi4vQXBwJyk7XG5jb25zdCB7IGNvbWJpbmUsIGNvbG9yaXplLCBzaW1wbGUgfSA9IEFwcC5sb2dnZXJQcm92aWRlci5mb3JtYXQ7XG5cbmZ1bmN0aW9uIHN0YXJ0Q29tbWFuZChjb21tYW5kTmFtZSwgY29tbWFuZEhhbmRsZXIsIGNvbmZpZywgbG9nZ2VyT3B0KSB7XG4gICAgaWYgKHR5cGVvZiBsb2dnZXJPcHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGxvZ2dlck9wdCA9IHtcbiAgICAgICAgICAgIGxldmVsOiBsb2dnZXJPcHRcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBsb2dnZXJPcHQgPSB7XG4gICAgICAgIGNvbG9yaXplOiB0cnVlLFxuICAgICAgICBsZXZlbDogJ2luZm8nLFxuICAgICAgICAuLi5sb2dnZXJPcHRcbiAgICB9O1xuXG4gICAgbGV0IGNsaUFwcCA9IG5ldyBBcHAoY29tbWFuZE5hbWUsIHsgXG4gICAgICAgIGxvZ2dlcjogeyAgICAgICAgXG4gICAgICAgICAgICBcInRyYW5zcG9ydHNcIjogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwiY29uc29sZVwiLFxuICAgICAgICAgICAgICAgICAgICBcIm9wdGlvbnNcIjogeyAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibGV2ZWxcIjogbG9nZ2VyT3B0LmxldmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJmb3JtYXRcIjogbG9nZ2VyT3B0LmNvbG9yaXplID8gY29tYmluZShjb2xvcml6ZSgpLCBzaW1wbGUoKSkgOiBzaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICB9LFxuICAgICAgICBsb2FkQ29uZmlnRnJvbU9wdGlvbnM6IHRydWUsXG4gICAgICAgIGNvbmZpZ1xuICAgIH0pO1xuXG4gICAgY2xpQXBwLnN0YXJ0XygpLnRoZW4oY29tbWFuZEhhbmRsZXIpLnRoZW4oKCkgPT4gY2xpQXBwLnN0b3BfKCkpLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgY2xpQXBwLmxvZ0Vycm9yKGVycm9yKTtcblxuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gc3RhcnRDb21tYW5kOyJdfQ==